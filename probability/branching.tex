% File: branching.tex
% Date: Wed Nov 27 12:29:38 2013 +0800
% Author: Yuxin Wu <ppwwyyxxc@gmail.com>
\section{Branching Process}
设$ X_k$表示第$ k$代的个数,$ X_0=1.$每个个体以相同的概率分布独立产生一定数量的后代.

设$ G_n(t)$是$ X_n$的PGF,$ G_1(t) = G(t) = \sum_{k=0}^\infty{p_k}t^k$.

则显然有$ G_n(t) = G(G_{n-1}(t))$

$ \E{X_n} = G'_n(1) = G'_{n-1}(G(1))G'(1) = G'_{n-1}(1)G'(1) = \cdots =[G'(1)]^n \xlongequal{def}\mu^n$

$ \Var{X_n} = \begin{cases} n\sigma^2 , \mu=1 \\ \sigma^2\mu^{n-1}\dfrac{\mu^n-1}{\mu-1}, \mu\neq 1\end{cases}$

\subsection{Extinction Probability}
在$ n$代或以前灭绝的概率$ e_n = P(X_n = 0) = G_n(0) = G(e_{n-1})$

由于$ G(t)$在$ [0,1]$单调增,$ e_2 = G(e_1) > G(0) = p_0 = e_1$,归纳可得$ e_n$单调增,设其极限为$ e$.

显然$ e$是$ G(t)$在$ [0,1]$上的不动点,且归纳易知是其最小不动点.

由于$ G(t)$过$ (0,p_0)$和$ (1,1)$且递增下凸,除$ 1$外可能还有一个或零个不动点.

当$ \mu = G'(1) \le 1$时,$ G(t)$的唯一不动点为$ 1$,即$ e = 1$,过程必然灭绝.

当$ \mu >1$时,灭绝概率趋于$ G(t)$的较小不动点.

\subsection{Total Progeny}
设$ Y_n = \sum_{k=0}^n{X_n},$其PGF为$ R_n(t), R_1(t) = tG(t)$

类似地,考虑所有人分别是$ X_1$中哪些人的 后裔,可得$ R_n(t) = tG(R_{n-1}(t))$

$ \forall t < 1, R_2(t) = tG(tG(t)) < tG(t) = R_1(t)$,归纳可得$ R_n(t)< R_{n-1}(t),$所以$ R_n(t)\to \rho(t)$

那么无穷代后的总后代数的PGF$ \rho(t)$是$ x = tG(x) $的根.

由凸性可知根至多有2个. 考查$ x=0, x=e, x=1$时的情形知根只有一个,在$ (0,e]$之间.

$ t = 1时显然\rho(1) = e.$ (因而$ e \ne 1$时$ \rho(t)$不是一个honest PGF)

$\E{Y_n} \to \begin{cases}\infty, \mu \ge  1\\\dfrac{1}{1-\mu}, \mu < 1\end{cases} $

\subsection{Geometric Distribution}
设个体繁衍的概率分布为几何分布,生成函数$ G(t) = \dfrac{q}{1-pt}$

可得$ G_n(t) = q\dfrac{p^n-q^n - (p^{n-1}-q^{n-1})pt}{p^{n+1}-q^{n+1}-(p^n-q^n)pt}$

灭绝概率$ e = \min\{\dfrac{q}{p},1\}$

总后代数分布$ \rho(t) = \dfrac{1-\sqrt{1-4pqt}}{2p}$

\subsection{Busy Periods}
顾客在整数时间独立到来接受单线程服务,时长为整数符合PGF:$ \beta(t)$,相互独立.

将每个顾客服务时间内到来的顾客都视为其后代,则后代个数为随机和$ X_1 + \cdots +X_N, X_i $表示$ i$时刻有没有顾客,为两点分布.

$ \Rightarrow $个体繁衍的PGF:$ G(t)= \beta(pt + q). $设$ \sigma = \beta'(1)$为平均时长.

根据灭绝判据,$ \mu = G'(1) = p\sigma \le 1$时,忙期一定会结束. $ \mu < 1$时,忙期内到达的顾客数期望有限.
\\

\textbf{Uninterrupted Period}:

以时刻作为Branching Process的元素,将每个顾客服务时间内的所有\textbf{时刻}视做服务开始时刻的后代.

对于一个时刻,其繁衍PGF为$ G(t) = q + p\beta(t)$. 其总后代数为相应的$ \rho(t),$这里包含了开始时刻无顾客的情形.

Uninterrupted Period要求开始时刻来了顾客,且每个顾客独立繁衍的总后代数即其总时间.

其PGF为$ \beta(\rho(t))$
